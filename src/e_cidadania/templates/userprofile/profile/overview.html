{% extends "base.html" %}
{% load i18n %}
{% load avatars %}

{% block title %}{% trans "Overview of your profile" %}{% endblock %}
{% block robots %}noindex,nofollow{% endblock %}

{% block content %}
    {% if GOOGLE_MAPS_API_KEY and user.get_profile.location %}
        <script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
        <meta name="viewport" content="initial-scale=1.0, user-scalable=yes">
        <script type="text/javascript">
            function initialize() {
                var latlng = new google.maps.LatLng( {{ user.get_profile.latitude }}, {{ user.get_profile.longitude }} );
                var opts = {
                    zoom: 10,
                    center: latlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var map = new google.maps.Map(document.getElementById("location"), opts);
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title:"User!"
                });
            };
        </script>
    {% endif %}
    <div id="profile">
    <div id="profile_right">
        <div id="avatar" class="span-3 center">
        	<a href="{% url profile_edit_avatar %}">
        		<img class="border" src="/static/generic.96.jpg" />
	    	</a>
        	<p><a href="{{ request.path_info }}edit/avatar/">{% if user.get_profile.has_avatar %}{% trans "Change avatar" %}{% else %}{% trans "Add avatar" %}{% endif %}</a></p>
	    </div>
	    
	   	<div>
			<p>{% trans "Username: " %} {{ user }}</p>
			<p>{% trans "Real name: " %} {{ user.first_name }} {{ user.last_name }}</p>
			<p>{% trans "Age: " %} {{ user. }}
			<p>{% trans "Member for: " %} {{ user.date_joined }}</p>
			<p>{% trans "E-mail:" %}
				<span class="{% if not email or not validated %}quiet red{% endif %}">
				{%if not email %}
				    {% trans "Not set yet" %}
				{% else %}
				    {{ email }}
				    {% if not validated %}
				        {% trans " (Not validated)" %}
				    {% endif %}
				{% endif %}
				</span>
			</p>
			<p>
			<label for="location">{% trans "Country" %}:</label>
			{% if user.get_profile.country %}
				{{ user.get_profile.get_country_display }}
			{% else %}
				<span class="quiet red">{% trans "Not set" %}</span>
			{% endif %}
			</p>
			
			<p>
			    {% trans "Ciudad: " %} {{ user.get_profile.province }}
			</p>
			
		</div>
    </div>
    
    <div id="profile_left">
        {% if GOOGLE_MAPS_API_KEY %}
		    <p>{% trans "Location" %}:
		        {% if user.get_profile.location %}
			        {{ user.get_profile.location }}
		        {% else %}
			        {% trans "Not set" %}
		        {% endif %}
		    </p>
		{% endif %}
		{% if user.get_profile.location %}
		    <div class="span-12 last">
		        <div id="location" style="width: 480px; height: 240px;"></div>
		    </div>
		{% endif %}
    </div>
    </div>

{% endblock %}

{% block content-related %}
	<div class="box">
		<h3>{% trans "Management:" %}</h3>
		<a href="{% url password_change %}">{% trans "Change password" %}</a>
		<br />
		<a href="{% url email_validation %}">{% if email %}{% trans "Change your e-mail address" %}{% else %}{% trans "Add your e-mail address" %}{% endif %}</a>
		{% if not validated and email %}<br /><a href="{% url email_validation_reset %}">{% trans "Resend validation e-mail" %}</a>
		{% endif %}
		<br />
		{% if not user.get_profile.location %}
			<a href="{% url profile_edit_location %}">{% trans "Add location" %}</a>
		{% else %}
			<a href="{% url profile_edit_location %}">{% trans "Change location" %}</a>
		{% endif %}
	</div>
{% endblock %}
